version: '3.8'

services:
  vps-tg-bot:
    build:
      context: .
      dockerfile: Dockerfile
    container_name: vps-tg-bot
    restart: unless-stopped
    environment:
      - TG_TOKEN=${TG_TOKEN}
      - TG_CHAT_ID=${TG_CHAT_ID}
      - CORE_SCRIPT=${CORE_SCRIPT:-/usr/local/bin/vps-maintain-core.sh}
      - RULES_SCRIPT=${RULES_SCRIPT:-/usr/local/bin/vps-maintain-rules.sh}
    volumes:
      # 挂载维护脚本（如果需要）
      - /usr/local/bin:/usr/local/bin:ro
      # 挂载系统命令（如果需要执行系统操作）
      - /bin:/bin:ro
      - /sbin:/sbin:ro
      - /usr/bin:/usr/bin:ro
      - /usr/sbin:/usr/sbin:ro
    # 如果需要执行系统操作，可能需要特权模式
    # privileged: true
    # 或者使用特定的 capabilities
    cap_add:
      - SYS_ADMIN
    network_mode: host
    # 如果需要日志
    logging:
      driver: "json-file"
      options:
        max-size: "10m"
        max-file: "3"
